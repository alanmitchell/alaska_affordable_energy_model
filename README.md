# alaska_affordable_energy_model
Alaska Energy Authority - Alaska Affordable Energy Model
Created by University of Alaska Fairbanks/GINA

# extra python libraries used:
numpy, scipy, pandas: info on those here: http://www.scipy.org/

pyyaml

## Installing dependencies
Dependencies for the Alask Affordable Energy Model can be installed using [pip](https://pypi.python.org/pypi/pip)

    pip install --user -r requirements.txt

# model files:
    aea_assumptions.py
        a place for the assumptions the Alaska energy association(administration?)(AEA) has made

    components/annual_savings.py
        Contains base class for each of the model components(tabs in the spreadsheet
    on basecamp) that have a financial forecasting section.

    components/community_buildigns.py
        python version of the eff(com) tab.

    community_data.py
        python version of community data tab. This is the inputs for the model,
    currently loaded from a .csv file

    diesel_prices.py
        python version of Diesel Fuel Prices tab.

    driver.py
        contains a function to test the model components together.

    forecast.py
        Python version of forecast tab. The object defined here is passed
    as input to model components that use/update its members

    components/interties.py
        Python version of interties tab.

    components/residential_buildings.py
         python version of the eff(res) tab.

    components/wastewater.py
        python version of the eff(w&ww) tab.

    README
        this file


# python examples:
from the aaem/ directory

    $ python
    Python 2.7.9 (default, Apr  2 2015, 15:33:21)
    [GCC 4.9.2] on linux2
    Type "help", "copyright", "credits" or "license" for more information.
    
The Preprocssor module contains the function preprocess to set up the data files the model needs to run
    
    >>> import preprocessor as p
    >>> p.preprocess(<input dir>,<out dir>,<commuinty id>) # input dir shoud be to a copy of the AAEM-data dir, out dir should be the data dir indcated in the driver config, and commuity id is the community name at this point.

the individual component test don't take any arguments and return the model components used

    >>> import components.wastewater as wastewater
    >>> ww, fc = wastewater.test()

    47797.0
    61254.0
    0.78
    13457.0
    >>> ww.benefit_cost_ratio
    0.78031511335568371
    >>> fc.www_HF
    array([    0.        ,   891.21513076,   929.59932095,   969.63669902,
        1011.39846696,  1054.95889336,  1100.39544556,  1147.78892734,
        1197.2236227 ,  1248.78744567,  1302.57209673,  1358.67322582,
        1417.1906025 ,  1478.22829334,  1541.89484701,  1608.30348732,
        1608.30348732,  1608.30348732,  1608.30348732,  1608.30348732,
        1608.30348732,  1608.30348732,  1608.30348732,  1608.30348732,
        1608.30348732,  1608.30348732,  1608.30348732])



example config


    |------ config_example.yaml -------------
    # note paths should be relative to this file or absolute
    overrides: # a path (ex:"../test_case/manley_data.yaml")
    defaults: # blank or a path
    data directory: # a path "../data/"
    output directory path: # a path
    output directory suffix: TIMESTAMP # TIMESTAMP|NONE|<string>
    -------------------------------------   
    
New Regression testing Info:

A directory structre for running regresion tests can be set up from the aaem directory:
    
    >>> import reg_test
    >>> reg_test.setup_reg_test("<path to reg test location>","<community name>", "< path to alaska_affordable_energy_model-data repo >")
    
This also runs the pre-processor and generates set up files needed for running the model, so it can be used to do that also. Note: the model is run here, and the results are stored in the baseline_results sub directory.  

To run the regression test use this function. Give it the path to the driver flie generated by the setup function

    >>> df, model = reg_test.reg_test("<path to reg test location>/<community>_driver.yaml", lim = .1)
    >>> df
          population   HH  consumption kWh  kWh generation     avg. kW  \
    year                                                                 
    2013         NaN  NaN    472207.308287          537000   61.325306   
    2014         NaN  NaN    426337.659279          485000   55.368240   
    2015  123.598659   57    456605.478533          519000   59.299105   
    2016  129.980917   60    485880.667825          553000   63.101058 .....
    
a file generated forecast_comparsion_results.csv is cerated it provides a grid of booleans based on the forecast. The cells are true if the new values are with in + or - the percent limit provied as a decimal. The limit by default is 10%(.1)


To reset the test case: delete the test case directory and run reg_test.setup_reg_test again after updating the model data, or copy the resultes directory into the baseline_results directory in the test case directory after runing the model with the updated data.
